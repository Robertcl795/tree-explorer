:host {
  /* Critical: Fixed height for virtual scrolling consistency */
  display: block;
  height: var(--tree-item-height, 32px);
  
  .tree-item {
    position: relative;
    border-bottom: 1px solid #f0f0f0;
    height: 100%;
    display: flex;
    align-items: center;

    &:not(.disabled) {
      cursor: context-menu;
    }

    &.disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    &.error {
      border-left: 2px solid #b00020;
    }
  }

  .tree-item:hover {
    background-color: #f5f5f5;
  }

  .tree-item:focus,
  .tree-item:focus-visible {
    outline: 2px solid #0b63ce;
    outline-offset: -2px;
    background-color: #eaf3ff;
  }

  .tree-item:hover .context-menu-button {
    opacity: 1 !important;
  }

  .item-content {
    display: flex;
    align-items: center;
    width: 100%;
    cursor: pointer;
    padding: 4px 8px;
    gap: 8px;
  }

  .caret-button {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
    border-radius: 4px;
    transition: background-color 0.2s ease;
    display: flex;
    padding: 0;
    align-items: center;
    justify-content: center;
    
    mat-icon {
      color: rgba(0, 0, 0, 0.54); // More neutral gray color
    }

    &:hover:not([disabled]) {
      background-color: rgba(0, 0, 0, 0.08);
    }

    &:disabled {
      cursor: default;
    }
  }

  .tree-item-icon {
    color: rgba(0, 0, 0, 0.54); // More neutral gray color for tree icons
    flex-shrink: 0;
  }

  .tree-item-label {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    color: rgba(0, 0, 0, 0.87);
  }

  .tree-item-placeholder {
    display: inline-block;
    width: min(180px, 50%);
    height: 10px;
    border-radius: 999px;
    background: linear-gradient(90deg, #eceff1 25%, #f5f7f8 50%, #eceff1 75%);
    background-size: 200% 100%;
    animation: tree-placeholder-shimmer 1.2s linear infinite;
  }

  .placeholder-text {
    color: rgba(0, 0, 0, 0.45);
    font-style: italic;
  }

  .row-spinner {
    position: absolute;
    left: 8px;
  }

  .tree-item--spacer {
    flex: 1;
  }

  .context-menu-button  {
    width: 32px;
    height: 32px;
    flex-shrink: 0;
    opacity: 0;
    transition: opacity 0.2s;
    
    mat-icon {
      color: rgba(0, 0, 0, 0.54);
    }
  }

  .context-menu-button:focus {
    opacity: 1 !important;
  }

  .checkbox-wrapper {
    display: flex;
    align-items: center;
    border-radius: 4px;
    padding: 4px;
    margin: -4px;
    transition: background-color 0.2s ease;
    cursor: pointer;

    &:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    mat-checkbox.mat-mdc-checkbox-disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  }

}

@keyframes tree-placeholder-shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}
